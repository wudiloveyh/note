# 主域名收集

## ICP备案查询

推荐使用官方的备案查询工具

[ICP/IP地址/域名信息备案管理系统](https://beian.miit.gov.cn/#/Integrated/index)

支持单位名称、域名、备案号查询

可以点击搜索到的条目的右边的详细按钮查看详细信息，可以找到这个资产的其他域名

**第三方工具**

[域名备案查询_备案查询_网站ICP备案查询 - 站长工具](https://icp.chinaz.com/)

[icp备案查询_网站备案查询_域名备案查询_APP备案查询_小程序备案查询_快应用备案查询_爱站网](https://icp.aizhan.com/)

## 证书查询

只要网站使用https访问的就有ssl证书，证书里面会记录这个证书有哪些域名在使用

浏览器url左边的锁点击就可以看到证书，这里以edge举例子

![image-20251126200454110](https://cdn.jsdelivr.net/gh/wudiloveyh/my-image-bucket@main/images/20251126200454206.png)

![image-20251126200631686](https://cdn.jsdelivr.net/gh/wudiloveyh/my-image-bucket@main/images/20251126200631734.png)

通过在线网站工具：[crt.sh | Certificate Search](https://crt.sh/)

输入域名即可查询

### 网络空间搜索引擎

FOFA为例：

| 语法                                | 说明                                          |
| :---------------------------------- | :-------------------------------------------- |
| `cert="baidu"`                      | 搜索证书(https或者imaps等)中带有baidu的资产。 |
| `cert.subject="Oracle Corporation"` | 搜索证书持有者是Oracle Corporation的资产      |
| `cert.issuer="DigiCert"`            | 搜索证书颁发者为DigiCert Inc的资产            |
| `cert.is_valid=true`                | 验证证书是否有效，true有效，false无效         |

## DNS共享记录查询

如果是公开的DNS服务器，查询的效果会非常差

先查询目标是否存在自建的NS服务器

```bash
nslookup -query=ns alibaba.com 119.29.29.29
```

将得到的nameserver结果放到网站上查询：

[Find all Hosts pointing to DNS Server](https://hackertarget.com/find-shared-dns-servers/)

会得到一些资产，但是不全是目标资产，需要进一步的确认和观察

## whois查询

通过查询目标的WHOIS信息，对联系人、联系邮箱等信息进行反查，获取更多相关的域名信息。

重点关注注册商、注册人、邮件、DNS解析服务器、注册人联系电话。

linux执行：

```bash
whois 域名
whois IP
whois -B 域名 # 禁用缓存
```

不过windows好像也有提供whois的软件下载：

https://learn.microsoft.com/sysinternals/downloads/whois

也可以用在线工具

http://whois.chinaz.com/

https://whois.aizhan.com/

https://whois.cloud.tencent.com/

https://whois.cnnic.cn/WelcomeServlet

https://whois.aliyun.com/

对于查询到的内容例如联系人或邮箱都可以进行反差去进一步搜索资产

## IP反查

有时候多个域名可能绑定在同一个IP上，通过IP反差一定情况下可以获取到其他域名的信息

[网站IP查询_IP反查域名_同IP网站查询 - 站长工具](https://tool.chinaz.com/same)

[Online investigation tool - Reverse IP, NS, MX, WHOIS and Search Tools](https://dnslytics.com/)

输入相关的域名或者IP地址就可以了

## 股权信息

通过股权信息或者股权穿透图，寻找子公司等，一般对外投资超过五十或者有行政权限都算是目标

手动查询：

https://www.tianyancha.com/

https://www.qcc.com/

工具推荐：

https://github.com/wgpsec/ENScan_GO.git

```bash
ENScan_GO -n "阿里巴巴" -type tyc 
```

这个工具确实好用

## Hackerone

一些在hackone众测的厂商会把自己的测试范围列举出来，包含了大量的域名，也是一种不错的收集方式

[HackerOne](https://hackerone.com/xiaomi/policy_scopes?type=team)

## google

google直接搜索里面的一些关键内容来查询，比如公司名、备案、引用的特殊js等，下面是阿里的例子

```bash
intext:浙ICP备09002987号 intext:33010002000070 -www
```

![image-20251126231443859](https://cdn.jsdelivr.net/gh/wudiloveyh/my-image-bucket@main/images/20251126231443950.png)